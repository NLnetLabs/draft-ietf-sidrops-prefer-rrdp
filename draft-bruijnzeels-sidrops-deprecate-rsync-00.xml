<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd' []>
<rfc ipr="trust200902" category="std" docName="draft-sidrops-bruijnzeels-deprecate-rsync-00" updates="6841">
<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc private=""?>
<?rfc topblock="yes"?>
<?rfc comments="no"?>
<front>
<title abbrev="RPKI Repository Requirements">Resource Public Key Infrastructure (RPKI) Repository Requirements</title>

<author initials="T." surname="Bruijnzeels" fullname="Tim Bruijnzeels">
<organization>NLnet Labs</organization>
<address>
<postal>
<street></street>
<city></city>
<code></code>
<country></country>
<region></region>
</postal>
<phone></phone>
<email>tim@nlnetlabs.nl</email>
<uri>https://www.nlnetlabs.nl/</uri>
</address>
</author>
<date year="2019" month="November" day="4"/>

<area>Internet</area>
<workgroup></workgroup>


<abstract>
<t>This document updates the profile for the structure of the Resource
Public Key Infrastructure (RPKI) distributed repository <xref target="RFC6481"/>
by describing how the RPKI Repository Delta Protocol (RRDP) <xref target="RFC8182"/>
can be used, and stipulating that repositories which are made available
over RRDP are no longer required to be available over rsync.
</t>
<t>The Profile for X.509 PKIX Resource Certificates <xref target="RFC6487"/> uses rsync
URIs in the Authority Information Access, Subject Information Access,
and CRL Distribution Points extensions. This document leaves this unchanged,
meaning that rsync URIs are still used for naming and finding objects in the RPKI.
However, it is no longer guaranteed that objects can be retrieved using these
URIs.
</t>
</abstract>


</front>

<middle>

<section anchor="requirements-notation" title="Requirements notation">
<t>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;,
&quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in
this document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they appear in all capitals, as shown here.
</t>
</section>

<section anchor="motivation" title="Motivation">
<t>The Resource Public Key Infrastructure (RPKI) <xref target="RFC6480"/> as originally defined
uses rsync as its distribution protocol, as outlined in <xref target="RFC6481"/>. Later, the
RPKI Repository Delta Protocol (RRDP) <xref target="RFC8182"/> was designed to provide an
alternative. In order to facilitate incremental deployment RRDP has been
deployed as an additional optional protocol, while rsync was still mandatory to
implement.
</t>
<t>RPKI Repository operators are still required to provide 24/7 up-time to their
rsync infrastructure, as long as the requirement to support rsync stands. Thus,
the benefit that they get from supporting RRDP, which enables the use of content
delivery networks (CDNs) for this purpose, is limited.
</t>
<t>And as long as not all RPKI Repositories support RRDP, Relying Party software is
still required to support rsync. Because there is a lack of rsync client
libraries, this is typically implemented by calling a system installed rsync
binary. This is inefficient, and has issues with regards to versioning of the
rsync binary, as well as reporting errors reliably.
</t>
<t>This document requires that all RPKI repositories and all Relying Parties support
RRDP. It also stipulates that these parties are no longer required to support
rsync. This way all parties are freed of direct operational dependencies on
rsync.
</t>
</section>

<section anchor="rsync-uris-as-object-identifiers" title="Rsync URIs as object identifiers">
<t><xref target="RFC6481"/> defines a profile for the Resource Certificate Repository Structure.
In this profile objects are identified through rsync URIs. E.g. a CA certificate
has an Subject Information Access descriptor which uses an rsync URI to identify
its manifest <xref target="RFC6486"/>. The manifest enumerates the relative names and hashes,
for all objects published under the private key of the CA certificate. This the
full rsync URI identifiers for each object can be resolved relative to the
manifest URI.
</t>
<t>Though it would be possible in principle to build up an RPKI tree hierarchy of
objects based on key identifiers and hashes <xref target="RFC8488"/>, most Relying Party
implementations have found it very useful to use rsync URIs for this purpose.
Furthermore, these identifiers make it much easier to name object in case of
validation problems, which help operators to address issues.
</t>
<t>For these reasons, RRDP still includes rsync URIs in the definition of the publish,
update and withdraw elements in the snapshot and delta files that it uses. See
section 3.5 of <xref target="RFC8182"/>. Thus, objects retrieved through RRDP can be mapped
easily to files and URIs, similar to as though rsync would have been used to
retrieve them.
</t>
</section>

<section anchor="updates-to-rfc6481" title="Updates to RFC6481">
<t>OLD:
</t>
<t>
<list style="symbols">
<t>The publication repository SHOULD be hosted on a highly
available service and high-capacity publication platform.</t>
<t>The publication repository MUST be available using rsync
<xref target="RFC5781"/> [RSYNC]. Support of additional retrieval mechanisms
is the choice of the repository operator.  The supported
retrieval mechanisms MUST be consistent with the accessMethod
element value(s) specified in the SIA of the associated CA or
EE certificate.</t>
</list>
</t>
<t>NEW:
</t>
<t>
<list style="symbols">
<t>The publication repository MUST be available using the RPKI
Repository Delta Protocol <xref target="RFC8182"/>. The RRDP server SHOULD
be hosted on a highly available platform.</t>
<t>The publication repository MAY be available using rsync <xref target="RFC5781"/>.</t>
<t>Support of additional retrieval mechanisms is the choice of the repository
operator. The supported retrieval mechanisms MUST be consistent with the
accessMethod element value(s) specified in the SIA of the associated CA or
EE certificate.</t>
</list>
</t>
</section>

<section anchor="deployment-considerations" title="Deployment Considerations">
<t>Relying Parties can drop support for rsync only when all RPKI repositories
support RRDP.
</t>
<t>RPKI repositories can drop support for rsync only when Relying Parties support
RRDP. Even when all actively maintained RP software packages support RRDP, there
will still be old versions of the software in operational use. It is most likely
impossible to find that all deployed software supports RRDP, but since RRDP SHOULD
be used when it is available [section 3.4.1 of @!RFC8182] it will be possible to
measure adoption.
</t>

<section anchor="rrdp-support-in-rpki-repositories" title="RRDP support in RPKI Repositories">
<t>[This section can be updated during discussion of this document, and may be
removed before possible publication.]
</t>
<texttable>
<ttcol align="center">Repository Implementation</ttcol>
<ttcol align="center">Support for RRDP</ttcol>

<c>afrinic</c><c>planned</c>
<c>apnic</c><c>yes</c>
<c>arin</c><c>under development</c>
<c>lacnic</c><c>planned</c>
<c>ripe ncc</c><c>yes</c>
<c>rpki.net</c><c>yes(1)</c>
<c>krill</c><c>yes(2)</c>
</texttable>
<t>(1) in use at various National Internet Registries, as well as other resource
    holders under RIRs.
(2) Software under development.
</t>
</section>

<section anchor="rrdp-support-in-relying-party-software" title="RRDP support in Relying Party software">
<t>[This section can be updated during discussion of this document, and may be
removed before possible publication.]
</t>
<texttable>
<ttcol align="center">Relying Party Implementation</ttcol>
<ttcol align="center">Support for RRDP</ttcol>

<c>FORT</c><c>no</c>
<c>OctoRPKI</c><c>yes</c>
<c>rcynic</c><c>yes</c>
<c>RIPE NCC RPKI Validator 2.x</c><c>yes</c>
<c>RIPE NCC RPKI Validator 3.x</c><c>yes</c>
<c>Routinator</c><c>yes</c>
<c>rpki-client</c><c>no</c>
<c>RPSTIR</c><c>yes</c>
</texttable>
</section>
</section>

<section anchor="iana-considerations" title="IANA Considerations">
<t>This document has no IANA actions.
</t>
</section>

<section anchor="security-considerations" title="Security Considerations">
<t>TBD
</t>
</section>

<section anchor="acknowledgements" title="Acknowledgements">
<t>TBD
</t>
</section>

</middle>
<back>
<references title="Normative References">
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5781.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6480.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6481.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6486.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6487.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8182.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8488.xml"?>
</references>

</back>
</rfc>
